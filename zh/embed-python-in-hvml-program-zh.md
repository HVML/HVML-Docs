# 在 HVML 程序中嵌入 Python

2023 年 3 月，HVML 社区发布了 HVML 开源解释器 PurC 的 0.9.7 版本，其中增加了对 Python 的支持。

使用这一增强，我们可以非常方便地在 HVML 程序中调用 Python 模块，利用 Python 生态中的丰富软件包或模块开发自己的 HVML 应用。与此同时，由 HVML 提供的跨平台、统一 GUI/CLI 应用开发框架以及跨端运行的能力，将弥补 Python 生态和 Web 生态之间几十年来难以跨越的鸿沟，从而极大提升 Python 应用的表现力以及和用户交互的能力。

在 PurC 0.9.8 版本中，对 Python 的支持被实现为 HVML 的一个外部动态变体对象 `$PY`，利用该对象提供的功能，我们可以在 HVML 程序中完成如下功能：

1. 装载指定的 Python 模块并可在其上访问或调用已装载模块提供的子模块、属性或函数。
1. 执行一段 Python 代码、一个 Python 脚本或者一个指定的模块，并获得结果。
1. 编译一段 Python 代码，之后可在编译后的 Python 代码对象上对其执行求值。
1. 可将 HVML 字符串、数组、元组、集合、对象等数据转换为 Python 的内部对象，然后在其上执行这些 Python 内部对象支持的方法，或使用这些对象调用其他 Python 模块或函数。
1. 将 Python 内部对象转换为对应的 HVML 数据，或者获取对应的字符串表达。

本文通过一个通过内嵌 Python 实现三维动画随机游走功能的 HVML 程序，介绍了这一增强的典型应用场景：科学计算可视化。

## 三维动画随机游走功能的基本实现思路

## 可装载动态对象 PY 的主要接口

## HVML 和 Python 代码的互操作

## 完整代码及其解析


