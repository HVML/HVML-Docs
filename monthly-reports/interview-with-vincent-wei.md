# 魏永明访谈录：关于 HVML、开源和国产基础软件

- 原创作者：魏永明
- 自媒体标题：（同标题）

__目录__

- [引言](#引言)
- [正文](#正文)
   + [有关 HVML](#有关-hvml)
   + [有关开源](#有关开源)
   + [有关国产基础软件](#有关国产基础软件)
- [原文链接](#原文链接)


## 引言

本文是近期魏永明和一些朋友们，就 HVML、开源以及国产基础软件的一些热点问题的交流和谈话内容整理而来。

## 正文

### 为什么要设计 HVML？

我搞了二十多年的 GUI 系统（编者注：指 MiniGUI），却越来越难以接受使用 C/C++ 语言来编写带有图形用户界面的应用程序，尤其在自己使用 Web 前端技术做了很多网页之后，我更加发现使用 C/C++ 这类编程语言开发 GUI 的尴尬：宛如用牛刀杀鸡。就算有可视化的界面设计器帮助开发者，其开发效率也很难和 Web 前端相比。

因此，这几年我一直在思考一个问题：能否将 Web 前端技术带到浏览器之外？比如可以让 C/C++ 程序轻松地使用 Web 前端技术来开发 GUI 应用。

为了将 Web 前端技术引入到通用的 GUI 应用开发中，开源社区也做了大量的探索性工作，比如 Electron 项目，就尝试用 Chromium + Node.js 来搞定一切。但这个项目未能流行起来，究其原因，跟 Web 前端技术本身的局限性有关：所有的一切都离不开浏览器，尤其是 JavaScript 编程语言。

为此，我们在开源的浏览器引擎 WebKit 中，尝试引入了一些具有动态能力的标签，可以用来实现循环迭代、分支控制等功能。有了这个基础，我提出了一个大胆设想：何不干脆设计一种全新的标记语言？于是，就有了 HVML。

简单来讲，HVML 尝试用一种新的思路来解决前面的那个问题：

1. 将 Web 前端技术（主要是 DOM、CSS 等）引入到其他编程语言中，而不是用 JavaScript 替代其他编程语言。
1. 采用类似 HTML 的描述式语言来操控 Web 页面中的元素、属性和样式，而非 JavaScript。

在设计 HVML 的过程中，我有意使用了数据驱动的概念，使得 HVML 可以非常方便地和其他编程语言结合在一起。这样，开发者熟悉哪种编程语言，就使用这种编程语言来开发应用的非 GUI 部分，而所有操控 GUI 的功能，交给 HVML 来完成，它们之间，通过模块间流转的数据来驱动。

### 使用 HVML 最重要的好处是什么？

围绕 HVML 形成的应用运行框架，和传统的 GUI 应用开发思路以及 Web 前端技术都有显著的不同。传统的 GUI 应用开发，设计模式无外乎直接调用 C/C++ 或其他编程语言提供的接口，在一个事件循环中完成创建 UI 元素，响应用户交互命令的工作。而使用 Web 前端技术开发 GUI 时，则必须使用 JavaScript 语言。

但 HVML 提供了一个完全不一样的应用框架。

在完整的基于 HVML 的应用框架中，包含一个独立运行的图形用户界面渲染引擎，开发者通过撰写 HVML 程序来操控渲染引擎，而 HVML 程序在 HVML 解释器中运行，并可以和其他已有的编程语言运行时环境绑定起来，接收由其他编程语言程序生成的数据，并按照 HVML 程序的指令，将其转换为图形用户界面的描述信息或者变更信息。通过这样的设计，我们将所有涉及到图形用户界面的应用程序分开成两个松散的模块：

1. 一个和 GUI 无关的数据处理模块，开发者可以使用任何其熟悉的编程语言和开发工具开发这个模块。比如，涉及到人工智能处理时，开发者选择 Python；在 Python 代码中，除了装载 HVML 程序之外，开发者无需考虑任何和界面渲染及交互相关的东西，比如创建一个按钮或者点击一个菜单后完成某项工作等等，开发者只需要在 Python 代码中准备好渲染界面所需要的数据即可。

1. 一个或者多个使用 HVML 语言编写的程序（HVML 程序），用来完成对用户界面的操控。HVML 程序根据数据处理模块提供的数据生成用户界面的描述信息，并根据用户的交互或者从数据处理模块中获得的计算结果来更新用户界面，或者根据用户的交互驱动数据处理模块完成某些工作。

通过这样的设计，HVML 应用框架将操控 GUI 的代码从原先调用 C、C++、Java、C# 接口的模式中解放了出来，转而使用 HVML 代码来处理。而 HVML 使用类似 HTML 的描述式语言来操控 GUI 元素，通过隐藏大量细节，降低了直接使用低级编程语言操控 GUI 带来的程序复杂度。

HVML 让几乎所有的编程语言，都可以轻松使用 Web 前端技术来开发 GUI 应用。仅这一点，就足以称之为一种全新的革命性技术。

### HVML 会开源吗？

当然会，而且还会以商业友好的宽松许可证发布，比如 LGPL。

因为还在开发阶段，除了单元测试用例之外，尚无法执行最终的程序看到实际效果，因此，我们没有向公众开放代码仓库。

但有兴趣的朋友，可以申请围观我们的开发过程：看一个全新的世界级开源基础软件项目，是如何从无到有诞生的。

### 围绕 HVML 编程语言有哪些软件需要开发？

围绕 HVML 的核心是 HVML 的解释器。理论上，每个和 HVML 配合的编程语言，都应该有一个 HVML 的解释器实现。但我们实现了 C 语言的 HVML 解释器之后，其他编程语言的解释器就很好实现了。所以，我们目前正在开发的就是 HVML 解释器的 C 语言实现，称之为 PurC。

另外一个软件是配合 HVML 解释器运行的 GUI 渲染器。我们正在开发的渲染器称为 xGUI，是一个跨平台的 HTML/XGML/CSS 渲染器，可运行在所有桌面操作系统以及合璧操作系统上。

如果要在资源受限的嵌入式系统中使用，还需要开发一个小型的 GUI 渲染器。为此，我们设计了一个 XGML 标记语言，专门用于嵌入式设备，我们称之为 xGUI Lite。

上述几款软件是用于运行时的，在开发阶段，还需要如下软件：

1. 开发及调试工具。
1. 自动化测试工具。

### 想过如何靠 HVML 赚钱吗？

说实话，直接拿一个编程语言赚钱似乎不太现实，也没听说任何成功案例。至于将来如何靠 HVML 赚钱，也没有想清楚。我想，还是先看用户价值吧。只有开发者认同了其价值，才有如何赚钱的问题，否则，就是个失败的尝试而已。

我设计并组织团队开发 HVML，主要的出发点是为了给国产基础软件的开发者们打个样，告诉大家什么如何在基础软件领域做一些开创性的工作，另一方面，也是为了实践我的操作系统方法论。但失败并不可怕，可拍的是我们从不做这类的尝试。

但从另外一个角度讲，如果团队无法直接或者间接地从 HVML 身上获得足够的收益，那说明这项技术无法得到市场的认同，也就没有坚持下去的理由。如果 HVML 技术得到开发者的认同，我相信找到合适的商业模式，也只是时间的问题。

目前，投入到 HVML 的资金，全部来自飞漫软件另外一个开源基础软件 MiniGUI 的许可收入。欢迎富豪打赏（见原文链接）或者赞助本项目。

### HVML 的开发为何未遵循您所谓的“过程开源”原则？

“过程开源”这个说法，其实是个噱头。有影响力的时候，你的一举一动都有人盯着，没有影响力的时候，开放过程给谁看呢？

所以，咱还是先达到第一个目标再说。等有了初步成果，然后搞个“Big Bong”出来，这样的宣传效果可能会更好。

### 大概何时能看到 HVML 的初步成果？

看目前的开发速度，大概需要半年左右，2022 年春节后吧。

### 如果 HVML 成功了，那会是什么样的一个场景？

我想，那些传统的、基于接口调用的 Toolkit 库将被消灭，比如 Gtk+、Qt，当然也包括我们自己的产品 MiniGUI。

### 能否谈谈您对开源的看法？

开源的好处大家已经谈得很多了，但任何事物都有两面性，开源也不例外。近几年，开源的坏处越来越多地表现了出来：

1. 出现了大量低水平复制其他开源软件设计思想甚至代码的开源软件，质量参差不齐。
1. 某些较为广泛使用的开源软件中，作者或者其他贡献者故意留出一些隐藏很深的缺陷或者漏洞。
1. 许多以宽松许可证发表的开源软件，发布就意味着项目的死亡。
1. 大量使用较多的开源基础软件得不到良好的维护。

本质上讲，开源只是一种软件的分发方式。如果你开发一个软件的目的是为了赚钱，那开源这个软件的行为，通常应该被定义为一种营销手段——希望通过开源的方式来让潜在用户或客户快速地用起来。

但现实的情况是，我们强调开源以及所谓开源社区治理等等高大上的概念时，忘了一项技术或者一个产品，能否得到广泛使用，首先要考虑的是市场是否有这个需求，或者这项技术、这个产品，能否给用户带来切实的好处。

就比如说，前几年物联网很热闹，国内很多大厂纷纷推出了自己的物联网操作系统。但这些物联网操作系统，代码规模不大，技术路线雷同，乏善可陈。但仍然有一些社区或者开发者，乐此不疲地开发新的物联网操作系统，只为借开源和国产操作系统的营销风儿搞个噱头。

基础软件本质上是工具。因此，在基础软件领域，如果一项新的技术或者产品，不能用来提高生产效率，解放生产力，那一定不是好的技术或产品。

我的建议是：少谈开源和社区治理，多谈技术和产品。

### 能否谈谈您对国产基础软件现状的看法？

国家花大价钱支持国产操作系统为代表的国产基础软件领域，已经二十年了。总体而言，有进步。但说实话，我们的竞争对手（美国）也在进步，而且人家底子好，进步速度更快。因此，二十年前，我们落后美国二十年，二十年后，我们落后美国三十年。

一句话：“革命尚未成功，同志任需努力！”

## 原文链接

<https://store.fmsoft.cn/campaign/denoteoss-lt>

